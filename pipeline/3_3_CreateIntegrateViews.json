{
	"name": "3_3_CreateIntegrateViews",
	"properties": {
		"activities": [
			{
				"name": "Log Integrate Start  ",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[Config].[usp_Loadlog]",
					"storedProcedureParameters": {
						"JobID": {
							"value": {
								"value": "@pipeline().parameters.JobID",
								"type": "Expression"
							},
							"type": "Int32"
						},
						"message": {
							"value": {
								"value": "@concat(pipeline().Pipeline, ' for JobId:',string(pipeline().parameters.JobID),' execution type :',string(pipeline().parameters.ExecutionTypeNum),\n' and Priority:',string(pipeline().parameters.Priority),' and Integration Id:',string(pipeline().parameters.IntegrationId),' Started')",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipelinename": {
							"value": {
								"value": "@pipeline().Pipeline",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SRC_Metadata",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "Log Integrate End",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "UpdateProcessPriority",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[Config].[usp_Loadlog]",
					"storedProcedureParameters": {
						"JobID": {
							"value": {
								"value": "@pipeline().parameters.JobID",
								"type": "Expression"
							},
							"type": "Int32"
						},
						"message": {
							"value": {
								"value": "@concat(pipeline().Pipeline, ' for JobId:',string(pipeline().parameters.JobID),' execution type :',string(pipeline().parameters.ExecutionTypeNum),\n' and Priority:',string(pipeline().parameters.Priority),' and Integration Id:',string(pipeline().parameters.IntegrationId),' Completed')",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipelinename": {
							"value": {
								"value": "@pipeline().Pipeline",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SRC_Metadata",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "UpdateIntegrateCurrentExecution",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "Log Integrate Start  ",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[Config].[usp_UpdateExecutionStatus]",
					"storedProcedureParameters": {
						"ExecutionTypeId": {
							"value": {
								"value": "@pipeline().parameters.IntegrationId",
								"type": "Expression"
							},
							"type": "Int32"
						},
						"JobId": {
							"value": {
								"value": "@pipeline().parameters.JobID",
								"type": "Expression"
							},
							"type": "Int32"
						},
						"Status": {
							"value": {
								"value": "InProgress",
								"type": "Expression"
							},
							"type": "String"
						},
						"ExecutionType": {
							"value": "Integration",
							"type": "String"
						},
						"PipelineRunId": {
							"value": {
								"value": "@pipeline().RunId",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SRC_Metadata",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "UpdateProcessPriority",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "UpdateIntegrateCurrentExecution",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[Config].[usp_UpdateProcessPriority]",
					"storedProcedureParameters": {
						"ProcessingId": {
							"value": {
								"value": "@pipeline().parameters.ProcessingId",
								"type": "Expression"
							},
							"type": "Int32"
						},
						"ProcessingType": {
							"value": {
								"value": "@pipeline().parameters.ProcessingType",
								"type": "Expression"
							},
							"type": "String"
						},
						"Priority": {
							"value": {
								"value": "@pipeline().parameters.i",
								"type": "Expression"
							},
							"type": "Int32"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SRC_Metadata",
					"type": "LinkedServiceReference"
				}
			},
			{
				"name": "Log Integrate Failed",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "UpdateIntegrateCurrentExecution",
						"dependencyConditions": [
							"Failed"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"storedProcedureName": "[Config].[usp_Loadlog]",
					"storedProcedureParameters": {
						"JobID": {
							"value": {
								"value": "@pipeline().parameters.JobID",
								"type": "Expression"
							},
							"type": "Int32"
						},
						"message": {
							"value": {
								"value": "@concat(pipeline().Pipeline, ' for JobId:',string(pipeline().parameters.JobID),' execution type :',string(pipeline().parameters.ExecutionTypeNum),\n' and Priority:',string(pipeline().parameters.Priority),' and Integration Id:',string(pipeline().parameters.IntegrationId),' Failed')",
								"type": "Expression"
							},
							"type": "String"
						},
						"pipelinename": {
							"value": {
								"value": "@pipeline().Pipeline",
								"type": "Expression"
							},
							"type": "String"
						}
					}
				},
				"linkedServiceName": {
					"referenceName": "LS_SRC_Metadata",
					"type": "LinkedServiceReference"
				}
			}
		],
		"parameters": {
			"Priority": {
				"type": "int",
				"defaultValue": 1
			},
			"JobID": {
				"type": "int",
				"defaultValue": 70
			},
			"MetadataServerName": {
				"type": "string",
				"defaultValue": "maidevasql.database.windows.net"
			},
			"MetadataDatabaseName": {
				"type": "string",
				"defaultValue": "dbMetadata"
			},
			"ExecutionTypeNum": {
				"type": "int",
				"defaultValue": 2
			},
			"i": {
				"type": "int",
				"defaultValue": 1
			},
			"IntegrationId": {
				"type": "int",
				"defaultValue": 14953
			},
			"ExecutionName": {
				"type": "string",
				"defaultValue": "DQValidation"
			},
			"ExecutionParameters": {
				"type": "string",
				"defaultValue": {
					"path": "abfss://maidatalake@maidevadls.dfs.core.windows.net/data/processed/dbdqvalidation/validation_email",
					"dbname": "dbDQValidation",
					"tablename": "Validation_Email",
					"JobId": "70",
					"DQEntityId": "17",
					"TypeOfValidation": "Custom",
					"CurrentQuery": "Select case when Count(1)>0 then 'Y' else 'N' end AS Result from dbCommon.Reporting_ScorecardTargetsFact",
					"PreviousQuery": "",
					"HigherThreshold": "0",
					"LowerThreshold": "0",
					"JobName": "Common-ELTL",
					"IsActive": "1"
				}
			},
			"DBName": {
				"type": "string",
				"defaultValue": "dbmaiinsights"
			},
			"ProcessingId": {
				"type": "int",
				"defaultValue": 17
			},
			"ProcessingType": {
				"type": "string",
				"defaultValue": "SPARK_WITHPARAM"
			},
			"ClusterName": {
				"type": "string",
				"defaultValue": "maicommonc1"
			},
			"SQLDWHServerName": {
				"type": "string",
				"defaultValue": "tcp:maidevsynapsews.sql.azuresynapse.net,1433"
			},
			"SQLDWHDatabaseName": {
				"type": "string",
				"defaultValue": "dbmaiinsights"
			}
		},
		"folder": {
			"name": "Framework/Template/3_IntegrationOrchestration"
		},
		"annotations": [],
		"lastPublishTime": "2023-02-03T03:30:47Z"
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}